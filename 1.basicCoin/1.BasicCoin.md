# ğŸš—Move Tutorial

## ì„¤ì¹˜

- ë ˆí¬ì§€í† ë¦¬ ë³µì‚¬

```
git clone https://github.com/move-language/move.git
```

- dev_setup.shìŠ¤í¬ë¦½íŠ¸ì‹¤í–‰

```
cd move
./scripts/dev_setup.sh -ypt
```

- í™˜ê²½ë³€ìˆ˜ ì„¤ì •

```
source ~/.profile
```

- ëª…ë ¹ì¤„ ë„êµ¬ ì„¤ì¹˜

```
cargo install --path language/tools/move-cli
```

## ğŸ“ëª¨ë“ˆì‘ì„±

- sources:packageì•  ëŒ€í•œ ëª¨ë“  moveì½”ë“œê°€ ìˆëŠ”ê³³
- move.toml:cargo.toml ê³¼ ìœ ì‚¬

```move
module 0xCAFE::BasicCoin {
    ...
}
```

- module:Moveì½”ë“œì˜ ë¹Œë”©ë¸”ë¡,íŠ¹ì • ì£¼ì†Œë¡œ ì •ì˜ëœë‹¤.
- BasicCoinì€ 0xCAFEì—ì„œë§Œ ê²Œì‹œí• ìˆ˜ ìˆë‹¤.

```move
module 0xCAFE::BasicCoin {
    struct Coin has key {
        value: u64,
    }

    public fun mint(account: signer, value: u64) {
        move_to(&account, Coin { value })
    }
}
```

- êµ¬ì¡°ì²´(struct)ë¥¼ ì •ì˜í•˜ê³  ì´ë¥¼ ê³„ì •ì— ì €ì¥í•˜ëŠ” í•¨ìˆ˜
- signer:ë³´ìœ ìê°€ íŠ¹ì •ì„ ëŒ€ì‹ í•´ì„œ í–‰ë™í• ìˆ˜ ìˆëŠ” ê¸°ëŠ¥ address
- ë¹Œë“œ

```
move build
```

## ë‹¨ìœ„ í…ŒìŠ¤íŠ¸

- Rustì˜ ë‹¨ìœ„ í…ŒìŠ¤íŠ¸ì™€ ë¹„ìŠ·

```
move test
```

```move
module 0xCAFE::BasicCoin {
    ...
    // Declare a unit test. It takes a signer called `account` with an
    // address value of `0xC0FFEE`.
    #[test(account = @0xC0FFEE)]
    fun test_mint_10(account: signer) acquires Coin {
        let addr = 0x1::signer::address_of(&account);
        mint(account, 10);
        // Make sure there is a `Coin` resource under `addr` with a value of `10`.
        // We can access this resource and its value since we are in the
        // same module that defined the `Coin` resource.
        assert!(borrow_global<Coin>(addr).value == 10, 0);
    }
}
```

- test_mint_10ì—ì„œ Coinêµ¬ì¡°ì²´ë¥¼ ìƒì„±í•˜ëŠ” ë‹¨ìœ„ í…ŒìŠ¤íŠ¸

## BasicCoin module ì„¤ê³„

- ê³µê°œ ì„œëª…

```move
/// Publish an empty balance resource under `account`'s address. This function must be called before
/// minting or transferring to the account.
public fun publish_balance(account: &signer) { ... }

/// Mint `amount` tokens to `mint_addr`. Mint must be approved by the module owner.
public fun mint(module_owner: &signer, mint_addr: address, amount: u64) acquires Balance { ... }

/// Returns the balance of `owner`.
public fun balance_of(owner: address): u64 acquires Balance { ... }

/// Transfers `amount` of tokens from `from` to `to`.
public fun transfer(from: &signer, to: address, amount: u64) acquires Balance { ... }
```

```rs
struct GlobalStorage {
    resources: Map<address, Map<ResourceType, ResourceValue>>
    modules: Map<address, Map<ModuleName, ModuleBytecode>>
}
```

```move
/// Struct representing the balance of each address.
struct Balance has key {
    coin: Coin // same Coin from Step 1
}

```

- moveì˜ ë¸”ë¡ì²´ì¸ ìƒíƒœ

- ê°€ì‹œì„±ì´ ìˆëŠ” í•¨ìˆ˜ë§Œ public(script)íŠ¸ëœì­ì…˜ì—ì„œ ì§ì ‘ í˜¸ì¶œí•  ìˆ˜ ìˆìŠµë‹ˆë‹¤. ë”°ë¼ì„œ transfer íŠ¸ëœì­ì…˜ì—ì„œ ì§ì ‘ ë©”ì„œë“œë¥¼ í˜¸ì¶œí•˜ë ¤ë©´ ì„œëª…ì„ ë‹¤ìŒê³¼ ê°™ì´ ë³€ê²½í•´ì•¼ í•©ë‹ˆë‹¤.

```move
public(script) fun transfer(from: signer, to: address, amount: u64) acquires Balance { ... }
```

- ì†”ë¦¬ë””í‹°ì™€ ë¹„êµ

## BasicCoin module êµ¬í˜„

```
move build
```

```move
let empty_coin = Coin { value: 0 };
move_to(account, Balance { coin:  empty_coin });
```

- publish_balance
- balanceëŠ” ì§€ì •ëœ ì£¼ì†Œì— ë¦¬ì†ŒìŠ¤ë¥¼ ê²Œì‹œ
- ì±„êµ´ì´ë‚˜ ì´ì²´ë¥¼ í†µí•´ ì½”ì¸ì„ ë°›ê¸°ìœ„í•´ í•„ìš”í•˜ê¸° ë•Œë¬¸ì—ëª¨ë“ˆ ì†Œìœ ìë¥¼ í¬í•¨í•œ ì‚¬ìš©ìê°€ ëˆì„ ë°›ê¸°ì „ì— ë©”ì„œë“œë¥¼ í˜¸ì¶œí•´ì•¼í•œë‹¤.

```move
assert!(signer::address_of(&module_owner) == MODULE_OWNER, ENOT_MODULE_OWNER);
```

- mintë©”ì„œë“œëŠ” ì£¼ì–´ì§„ ê³„ì •ì— ë™ì „ì„ ë°œí–‰
- mintì—ì„œ ëª¨ë“ˆ ì†Œìœ ìì˜ ìŠ¹ì¸ì„ ë°›ì•„ì•¼ í•œë‹¤.. assert ë¬¸ì„ ì‚¬ìš©í•˜ì—¬ ì´ë¥¼ ì‹œí–‰
- Moveì˜ Assert ë¬¸ì€ ë‹¤ìŒê³¼ ê°™ì´ ì‚¬ìš©í•  ìˆ˜ ìˆë‹¤.
- assert!(<predicate>, <abort_code>);. ì¦‰, <predicate> ê°€ ê±°ì§“ì´ë©´ ë¡œ íŠ¸ëœì­ì…˜ì„ ì¤‘ë‹¨í•œë‹¤.
- <abort_code>. ì—¬ê¸°ì—ì„œ MODULE_OWNERë° ENOT_MODULE_OWNERëª¨ë“ˆì˜ ì‹œì‘ ë¶€ë¶„ì— ì •ì˜ëœ ë‘ ìƒìˆ˜ì´ë‹¤.
- í‘œì¤€ ë¼ì´ë¸ŒëŸ¬ë¦¬ì˜ errorëª¨ë“ˆ ì€ ìš°ë¦¬ê°€ ì‚¬ìš©í•  ìˆ˜ ìˆëŠ” ì¼ë°˜ì ì¸ ì˜¤ë¥˜ ë²”ì£¼ë„ ì •ì˜í•œë‹¤.
- MoveëŠ” ì‹¤í–‰ ì‹œ íŠ¸ëœì­ì…˜ ë°©ì‹ì´ë¼ëŠ” ì ì— ìœ ì˜í•´ì•¼ í•©ë‹ˆë‹¤.
- ë”°ë¼ì„œ ì¤‘ë‹¨ ì´ ë°œìƒí•˜ë©´ í•´ë‹¹ íŠ¸ëœì­ì…˜ì˜ ë³€ê²½ ì‚¬í•­ì´ ë¸”ë¡ì²´ì¸ì— ì§€ì†ë˜ì§€ ì•Šìœ¼ë¯€ë¡œ ìƒíƒœ í•´ì œë¥¼ ìˆ˜í–‰í•  í•„ìš”ê°€ ì—†ìŠµë‹ˆë‹¤.

```move
deposit(mint_addr, Coin { value: amount });
```

- ê·¸ëŸ° ë‹¤ìŒ ê°€ì¹˜ê°€ ìˆëŠ” ì½”ì¸ amountì„ ì˜ ì”ì•¡ì— ì˜ˆì¹˜í•©ë‹ˆë‹¤ mint_addr.

```
borrow_global<Balance>(owner).coin.value
                 |       |       \    /
        resource type  address  field names
```

- ê¸€ë¡œë²Œ ìŠ¤í† ë¦¬ì§€ ì—°ì‚°ì ì¤‘ í•˜ë‚˜ì¸ ë¥¼ ì‚¬ìš© borrow_globalí•˜ì—¬ ê¸€ë¡œë²Œ ìŠ¤í† ë¦¬ì§€ì—ì„œ ì½ìŠµë‹ˆë‹¤.

```move
fun withdraw(addr: address, amount: u64) : Coin acquires Balance {
    let balance = balance_of(addr);
    assert!(balance >= amount, EINSUFFICIENT_BALANCE);
    let balance_ref = &mut borrow_global_mut<Balance>(addr).coin.value;
    *balance_ref = balance - amount;
    Coin { value: amount }
}
```

- ì´ ê¸°ëŠ¥ì€ ì˜ ì”ì•¡ì—ì„œ í† í°ì„ ì¸ì¶œ fromí•˜ê³  í† í°ì„ s ì”ì•¡ì— ì…ê¸ˆí•©ë‹ˆë‹¤ to. withdrawë„ìš°ë¯¸ ê¸°ëŠ¥ ì„ ìì„¸íˆ ì‚´í´ë³´ê² ìŠµë‹ˆë‹¤

## ëª¨ë“ˆë¡œ ë‹¨ìœ„ í…ŒìŠ¤íŠ¸ ì¶”ê°€ ë° ì‚¬ìš©

```
move test
```

## BasicCoinëª¨ë“ˆ ì¼ë°˜í™”

## Move Priverì‚¬ìš©

## ëª¨ë“ˆ ê³µì‹ ì‚¬ì–‘ ì‘ì„±
